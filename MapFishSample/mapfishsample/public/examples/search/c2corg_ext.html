<!DOCTYPE html>
<html>
  <head>
    <title>Search</title>
    <link rel="stylesheet" type="text/css" href="../../mfbase/ext/resources/css/ext-all.css" />

    <script type="text/javascript" src="../../mfbase/openlayers/lib/Firebug/firebug.js"></script>
    <script type="text/javascript" src="../../mfbase/openlayers/lib/OpenLayers.js"></script>

    <script type="text/javascript" src="../../mfbase/ext/adapter/ext/ext-base.js"></script>
    <script type="text/javascript" src="../../mfbase/ext/ext-all-debug.js"></script>
                    

    <script type="text/javascript">
      // Because of a bug in Firefox 2 we need to specify the MapFish base path.
      // See https://bugzilla.mozilla.org/show_bug.cgi?id=351282
      var gMfLocation = "../../mfbase/mapfish/";
    </script>
    <script type="text/javascript" src="../../mfbase/mapfish/MapFish.js"></script>

    <script type="text/javascript">
        // make map global - useful for debug
        var map;
        var vectorLayer;
        var featureArray;

        Ext.onReady(function() {

            var vectorStyle = OpenLayers.Util.extend(
                {}, OpenLayers.Feature.Vector.style['default']
            );
            vectorStyle.externalGraphic =
                "http://boston.openguides.org/markers/AQUA.png";
            vectorStyle.graphicWidth = 20;
            vectorStyle.graphicHeight = 20;
            vectorStyle.graphicYOffset = -20;
            vectorStyle.fillOpacity = 1.0;

            var scales = [
                442943842.5, 221471921.25, 110735960.625, 55367980.3125, 27683990.15625,
                13841995.078125, 6920997.5390625, 3460498.76953125, 1730249.384765625,
                865124.6923828125, 432562.34619140625, 216281.17309570312, 108140.58654785156,
                54070.29327392578
            ];
        
            var options = {
                projection: "EPSG:4326",
                controls: [new OpenLayers.Control.MouseDefaults()] , 
                maxExtent: new OpenLayers.Bounds(-180, -90, 180, 90),
                scales: scales
            };
        
            map = new OpenLayers.Map('map', options);

            var layer;
            
            var layer = new OpenLayers.Layer.WMS("OpenLayers WMS", 
                "http://labs.metacarta.com/wms/vmap0",
                {layers: 'basic'}, 
                {isBaseLayer: true}
            );
            layer.setVisibility(true);
            map.addLayer(layer);

            layer = new OpenLayers.Layer.WMS( "World Map", 
                "http://world.freemap.in/cgi-bin/mapserv?", 
                {
                    map: '/www/freemap.in/world/map/factbooktrans.map',
                    transparent: true,
                    layers: 'factbook',
                    format: 'image/png'
                }
            );
            layer.setVisibility(false);
            map.addLayer(layer);
          
            layer = new OpenLayers.Layer.WMS("Summits",
                "http://demo.mapfish.org/cgi-bin/mapserv-c2corg-v0.2?",
                {layers: ['summits'], format: 'image/png', transparent: true,
                 singleTile: true}
            );
            layer.setVisibility(true);
            map.addLayer(layer);  

            layer = new OpenLayers.Layer.WMS("Areas",
                "http://demo.mapfish.org/cgi-bin/v0.2_tilecache/tilecache.cgi?",
                {layers: ['c2corg'], format: 'image/png', transparent: true},
                {reproject: false}
            );
            layer.setVisibility(true);
            map.addLayer(layer);  

            vectorLayer = new OpenLayers.Layer.Vector("vector", {
                style: vectorStyle,
                displayInLayerSwitcher: false
            });
            map.addLayer(vectorLayer);
        
            map.setCenter(new OpenLayers.LonLat(5,45), 6);
            map.addControl(new OpenLayers.Control.PanZoomBar());
            map.addControl(new OpenLayers.Control.LayerSwitcher());

            var searchPoint = new mapfish.widgets.search.Point({
                el: 'widget', map: map, url: '../../c2corg',
                maxFeatures: 10, radius: 10000, autoHeight: true,
                autoWidth: true});
            searchPoint.render();
        });
     </script>
     <style type="text/css">
        @import "../../base.css";
        .float-left {
          float: left;
        }
        .clear-left {
          clear: left;
        }
        #map {
          width: 600px;
          height: 400px;
          border: 1px solid black;
        }
        #widget {
          margin-left: 20px;
        }
     </style>
  </head>

  <body>
    <div id="header"><a href="../../"><img id="header-logo" src="../../mapfish.png"/></a></div>
    <h1 class="page-title">Search Example</h1>
    <div id="content">
      <div id="map" class="float-left"></div>
      <div id="widget" class="float-left"></div>
      <div class="clear-left"></div>
    </div>
  </body>
</html>
